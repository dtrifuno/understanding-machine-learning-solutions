\chapter{The VC-Dimension}

\begin{ex}
  Suppose not, i.e.\ suppose that $\H'\subseteq \H$, but
  $\VCdim(\H')>\VCdim(H)=n$. Then there exists some set $C\subseteq \X$, with
  $|C|=n+1$ that $\H'$ shatters. However, since $\H'\subseteq \H$, it follows
  that $\H'_C\subseteq \H_C$ and therefore $\H$ also shatters $C$,
  contradicting the assumption that $\VCdim(\H)=n$.
\end{ex}

\begin{ex}
  \begin{enumerate}
    \item[]
    \item Let $n$ be the cardinality of the domain set $\X$. Then, the
          VC-dimension of $\H^\X_{=k}$ is $\min(k, n-k)$.

          First, note that it is never possible to shatter a set of $k+1$
          points, since there is no $h\in\H^\X_{=k}$ such that $h(x)=1$ for
          $k+1$ different points. Likewise, it is never possible to shatter a
          set of $n-k+1$ points, since if a hypothesis assigns the value $1$ to
          exactly $k$ elements, it must assign the value $0$ to exactly $n-k$
          elements, and hence there is no hypothesis corresponding to the
          constant $0$ function.

          Next, suppose that $k\leq n-k$. Let $C=\{p_i\}_{i=1}^k$ be a subset of
          $\X$, and note that for any $\vec{v}\in\{0,1\}^k$, we can construct a
          hypothesis $h(p_i)=v_i$, since we know that at most $k$ of the $v_i$'s
          are going to be $1$, and that there are at least $k$ more elements in
          $X\setminus C$ that we can map to $1$ in order to satisfy the
          condition on the hypothesis space.

          Finally, suppose that $n-k\leq k$. Let $D=\{p_i\}_{i=1}^{n-k}$ be a
          subset of $\X$, and note that any function $h:D\to \{0,1\}^{n-k}$ is
          in $H^\X_{=k}$, since $|D|=n-k\leq k$, and hence $h$ can assign the
          value $1$ enough times and $|\X\setminus D|=n-(n-k)=k\geq n-k$, and
          hence $h$ can assign the value $0$ enough times.
    \item Let $n$ be the cardinality of the domain set $\X$. Then
          \begin{align*}
            \VCdim(\H^\X_{\text{at-most-$k$}})=\begin{cases}
              n & \text{if $n\leq 2k+1$}, \\
              k & \text{otherwise}.
            \end{cases}
          \end{align*}

          First, note that if $n\leq 2k+1$, then for every $f\in \X^{\{0, 1\}}$,
          it is either going to take on the value $1$ at most $k$ times, or the
          value $0$ at most $k$ times, and hence is in
          $\H^\X_{\text{at-most-$k$}}$.

          Next, suppose that $n>2k+1$. Note that it is never possible to shatter
          a set $C$ of $k+1$ points, since a function that returns $1$ for the
          $k+1$ elements of $C$ will have to return $0$ for the remaining
          $|\X\setminus C|>k$ elements, and thus is not of the hypothesis class.

          Finally, note that if $C=\{p_i\}_{i=1}^k$, we can always construct a
          hypothesis $h(p_i)=v_i$ for any $\vec{v}\in \{0,1\}^k$, by specifying
          that $h(x)=0$ if $x\in \X\setminus C$ and observing that $h$ then
          assigns the value $1$ at most $k$ times.
  \end{enumerate}
\end{ex}

\begin{ex}
  Note that there is a one-to-one correspondence between hypotheses in
  $\H_{n-\text{parity}}$ and subsets of $[n]$, by mapping each hypothesis $h_I$
  to $I\subseteq [n]$. Hence, $|\H_{n-\text{parity}}|=2^n$, and it follows by
  the VC-dimension bound on finite classes that
  $\VCdim(\H_{n-\text{parity}})\leq n$.

  To show that the VC-dimension is $n$, it remains to show that the hypothesis
  class can shatter a set of cardinality $n$. Let $C=\{e_i\}_{i=1}^n$, the set
  of unit vectors, and note that for any $\vec{v}\in \{0, 1\}^n$, if we define
  $I=\{i\in [n]\mid v_i = 1 \}$, the hypothesis $h_I$ maps $e_i$ to $v_i$.
  Hence, $\H_{n-\text{parity}}$ shatters $C$.
\end{ex}

\begin{ex}
\end{ex}

\begin{ex}
  First, we produce a set $C=\{p_m\}_{m=1}^{2d}$ that $\H_{\text{rec}}^d$
  shatters, by defining every coordinate of $p_{2i}$ to be zero, except the
  $i$th coordinate which we take to be $1$, and letting every coordinate of
  ${p_{2i+1}}$ be zero, except the $i$th coordinate which we take to be $-1$.
  Note that hypotheses in $\H_{\text{rec}}^d$ are parametrized by vectors
  $(t_{1,\text{low}}, t_{1,\text{high}},\ldots,t_{d,\text{low}},t_{d,\text{high}})$
  with $t_{i,\text{low}}<t_{i,\text{high}}$ for all $i$, where
  $t_{i,\text{low}}$ and $t_{i,\text{high}}$ denote, respectively, the lowest
  and highest value of the $i$th coordinate of the rectangle. Then, given any
  $\vec{v}\in\{0, 1\}^{2d}$, we can construct the axis-aligned rectangle corresponding
  to the vector given by $t_{i,\text{low}}=-v_{2i+1}-\frac{1}{2}$ and
  $t_{i,\text{high}}=v_{2i}+\frac{1}{2}$ and note that it produces the desired
  labelling.

  Next, consider a set $D$ of $2d+1$ points and take the minimal axis-aligned
  rectangle that contains it. Note that we can parametrize this rectangle by
  taking the minimum and maximum coordinate of all points in our set along each
  axis, but that since there are $2d$ such parameters, and $2d+1$ points, by the
  pigeonhole principle there must exist a point $p$ that we can exclude from the
  set, but still have the same minimum rectangle over the remaining points.
  Hence, it is not possible for a hypothesis in $\H_{\text{rec}}^d$ to label all
  of $D\setminus\{p\}$ with $1$, but $p$ with $0$.
\end{ex}

\begin{ex}
\end{ex}

\begin{ex}
  \begin{enumerate}
    \item[]
    \item For any real number $a$, let
          \begin{align*}
            h_a(x)=\begin{cases}
              1 & \text{if $x < a$}, \\
              0 & \text{otherwise},
            \end{cases}
          \end{align*}
          and let $\H=\{h_a \mid a\in [0, 1] \}$, the set of threshold
          functions over the unit interval. Then $\H$ shatters
          $\{0.5\}$, since $h_1(0.5)=1$ and $h_0(0.5)=0$, but $\H$
          cannot shatter a set of two points, since given $\{p_1, p_2\}$ with
          $p_1 < p_2$, there is no $h_a$ such that $h_a(p_2) = 1$, but
          $h_a(p_1)=0$. Thus, $\VCdim(\H)=1$ despite the fact that $\H$ is
          infinite.
    \item Let $\H$ consist of the constant $0$ and the constant $1$ functions,
          and note that it shatters a singleton set, but cannot shatter a set of
          two points, since it cannot map the two points to different values.
          Hence, $\VCdim(\H)=1=\log_2(|\H|)$.
  \end{enumerate}
\end{ex}

\begin{ex}
  Fix a positive integer $k$, and let $\{\vec{b}_i\}_{i=1}^{2^k}$ be the set
  of all length $k$ binary vectors. In particular, we take $\vec{b}_{2^k}$ to be
  $(1,1,\ldots,1)$. Let $C=\{p_i\}_{i=1}^k$ where
  $p_m=0.b_{1,m}b_{2,m}\cdots b_{2^k,m}$, i.e.\ $p_m\in(0,1)$ and the
  $i$th digit in its binary expansion consists of the $m$th coordinate of
  $\vec{b}_i$.

  Given any labelling $\vec{v}$, note that there exists a
  $\vec{b}_j=(1,1,\ldots,1)-\vec{v}$ for some $j\in [2^k]$, and that therefore
  $\lceil(\sin(2^j\pi p_i) \rceil = 1 - p_{i,j}=v_i$. Hence, $\H$ shatters $C$,
  but since the size of $C$ was arbitrary, it follows that $\VCdim(\H)=\infty$.
\end{ex}

\begin{ex}
  Consider a set of $3$ points, and note that $\H$ shatters it, since given a
  labelling of all ones or all minus ones, we can take the interval that
  includes all three points with the appropriate sign, and since any other
  labelling would have only a single one or a single minus one, which we can
  produce from an interval that contains only that point, with the appropriate
  sign.

  Moreover, $\H$ cannot shatter any set of $4$ points, since given
  $\{p_1,p_2,p_3,p_4\}$, with $p_1<p_2<p_3<p_4$, we cannot produce the labelling
  $(1,-1,1,-1)$, since any positive interval that includes $p_1$ and $p_3$, must
  also include (and thus mislabel) $p_2$, while any negative interval that
  includes $p_2$ and $p_4$ will mislabel $p_3$.

  Hence, $\VCdim(\H)=3$.
\end{ex}

\begin{ex}
\end{ex}

\begin{ex}
\end{ex}

\begin{ex}
  \begin{enumerate}
    \item[]
    \item Suppose $POS(\F+g)$ can shatter a set of $k$ points,
          $\{p_i\}_{i=1}^k$. Then given a labeling $\vec{v}$, there exists an
          $f^+\in \F$, such that $f^+(p_i)+g(p_i)>0$ if and only if $v_i=1$,
          and an $f^-\in \F$ such that $f^-(p_i)+g(p_i)\leq 0$ if and only
          $v_i=1$. Therefore,
          $f^+(p_i)+g(p_i)-(f^-(p_i)+g(p_i))=f^+(p_i)-f^-(p_i)>0$
          if and only if $v_i=1$. However, $f^+-f^-\in \F$, and therefore
          $\VCdim{(POS(\F))}\geq \VCdim(POS(\F+g))$.

          Suppose $POS(\F)$ can shatter a set of $k$ points, $\{p_i\}_{i=1}^k$.
          Consider a labelling $\vec{v}$, and suppose we are given an $f\in \F$
          such that $f(p_i)>0$ if and only if $v_i=1$. Moreover, suppose that
          $f(p_i)\neq 0$ for any $p_i$. Let
          \[
            M=\min_{i\in [k]} |f(p_i)|,\quad K=\max_{i\in [k]} |g(p_i)|
          \]
          and note that $|\frac{K+1}{M}f(p_i)|>|g(p_i)|$ for all $p_i$,
          and hence that
          \[
            \frac{K+1}{M}f(p_i)+g(p_i) > 0
          \]
          if and only if $v_i=1$. Hence, $POS(\F+g)$ also shatters
          $\{p_i\}_{i=1}^k$, and we have
          $\VCdim(POS(\F+g))\geq \VCdim{(POS(\F))}$.

          It only remains to show that we can assume that $f(p_i)\neq 0$
          without loss of generality. Consider the labelling $1-\vec{v}$ and let
          $f^-\in \F$ such that $f^-(p_i)=1-v_i$. Then, let $g$ equal $f-f^-$,
          and note that $g\in \F$, with $g(p_i)>0$ if and only if $v_i=1$,
          but such that $g(p_i)\neq 0$.
    \item Suppose $\dim(\mathcal{F})=d$ and let $C\subseteq \R^{n}$
          with $|C|=d+1$. Define the map $A:\mathcal{F}\to\R^{d+1}$ by
          $f\mapsto (f(x_1),\ldots,f(x_{d+1}))$, and note that it is a linear
          map. Moreover, this map gives us a natural way to identify $\R^{d+1}$
          with the space of real-valued functions on $C$. Since the
          dimension of $\mathcal{F}$ is $d$, the map $A$ cannot be onto and
          thus there must exist a $\vec{b}\neq 0$ that is orthogonal to
          $\Im(A)$. Viewing $\vec{b}$ as a function on $C$ induces a labeling
          $\vec{v}$ such that $v_i=1$ if and only if $b_i>0$. Suppose that
          there exists a $g\in\mathcal{\F}$ that corresponds to the same
          labeling and note that then $\la A(g), v \ra > 0$, a contradiction.
          Hence, $\mathcal{F}$ cannot shatter a set of size $d+1$ and
          $\VCdim(\mathcal{F}) \leq d$.

          Conversely, fix a basis $\{f_1,\ldots,f_d\}$ of $\mathcal{F}$ and let
          $g:\R^n \to \R^d$ be given by $\x\mapsto (f_1(\x),\ldots,f_d(\x))$.
          Note that we can pick a set $S=\{\x_1,\ldots \x_d\}$ such
          that $g(S)$ is linearly independent, by first choosing a $\x_1$ such
          that $f_1(\x_1)\neq 0$, then a $\x_2$ such that
          $\{(f_1(\x_1), f_2(\x_1)), (f_1(\x_2), f_2(\x_2))\}$ is independent,
          and so on, noting that if at some step no such $\x_i$ exists, we have
          a contradiction to the fact that the $\{f_1, \ldots,f_d\}$ are
          linearly independent. Therefore, the restriction of $\mathcal{F}$
          to $S$ is of full dimension, and hence $POS(\mathcal{F})$ shatters
          $S$.
    \item
    \item[]
          \begin{enumerate}[1.]
            \item Let $L_n=\{h_{\vec{w},b} \mid \vec{w}\in\R^n, b\in \R\}$
                  where
                  $h_{\vec{w},b}(\vec{x}) =\langle\vec{w},\vec{x}\rangle + b$
                  and note that $L_n$ is linearly closed since
                  \begin{align*}
                    (h_{\vec{w}_1,b_1}+rh_{\vec{w}_2,b_2})(\x)
                     & =\langle\vec{w}_1,\x\rangle + b_1
                    +r\langle\vec{w}_2,\x\rangle + rb_2        \\
                     & =\langle\vec{w}_1+r\vec{w}_2, \x\rangle
                    + b_1 + rb_2                               \\
                     & =h_{\vec{w}_1+r\vec{w}_2,b_1+rb_2}(\x).
                  \end{align*}
                  Hence, $HS_n$, the class of half-spaces over $\R^n$,
                  is a Dudley class since $HS_n=POS(L_n)$.
            \item Let $L^\circ_n=\{h_{\vec{w}} \mid \vec{w}\in\R^n \}$
                  where $h_{\vec{w}}(\vec{x})=\langle\vec{w},\vec{x}\rangle$
                  and note that $L^\circ_n$ is linearly closed since
                  \begin{align*}
                    (h_{\vec{w}_1}+rh_{\vec{w}_2})(\x)
                     & =\langle\vec{w}_1,\x\rangle
                    +r\langle\vec{w}_2,\x\rangle              \\
                     & =\langle\vec{w}_1+r\vec{w}_2,\x\rangle \\
                     & =h_{\vec{w}_1+r\vec{w}_2}(\x).
                  \end{align*}
                  Hence, $HHS_n$, the class of homogeneous half-spaces
                  over $\R^n$, is a Dudley class since
                  $HHS_n=POS(L^\circ_n)$.
            \item Let $U_d=\{h_{\vec{a}, r} \mid \vec{a}\in\R^d, r\in\R\}$
                  where $h_{\vec{a},r}(\x)=r+2\la\x,\vec{a}\ra-\|\vec{a}\|^2$.
                  Then
                  \begin{align*}
                     & (h_{\vec{a}_1,r_1} + ch_{\vec{a}_2,r_2})(\x) \\
                     & \quad =r_1+2\langle\x,\vec{a}_1\rangle
                    -\|\vec{a}_1\|^2
                    +cr_2+2c\langle\x,\vec{a}_2\rangle
                    -c\|\vec{a}_2\|^2                               \\
                     & \quad =r_1+cr_2
                    -\|\vec{a}_1\|^2
                    -c\|\vec{a}_2\|^2
                    +2\la \x, \vec{a}_1 + c\vec{a}_2 \ra            \\
                     & \quad =r_1+cr_2
                    -\|\vec{a}_1\|^2
                    -c\|\vec{a}_2\|^2
                    +\|\vec{a}_1+c\vec{a}_2\|^2
                    +2\langle\x,\vec{a}_1+c\vec{a}_2\rangle
                    -\|\vec{a}_1+c\vec{a}_2\|^2,
                  \end{align*}
                  or, letting $K=
                    r_1+cr_2
                    -\|\vec{a}_1\|^2
                    -c\|\vec{a}_2\|^2
                    +\|\vec{a}_1+c\vec{a}_2\|^2
                  $,
                  \begin{align*}
                    (h_{\vec{a}_1,r_1} + ch_{\vec{a}_2,r_2})(\x)
                    =K+2\langle\x,\vec{a}_1+c\vec{a}_2\rangle
                    -\|\vec{a}_1+c\vec{a}_2\|^2
                    =h_{\vec{a}_1+c\vec{a}_2, K}(\x),
                  \end{align*}
                  showing that $U_d$ is linearly closed.

                  Next, consider $POS(U_d-\|\x\|^2)$, and note that
                  \begin{align*}
                    r+2\la \x, \vec{a}\ra -\|\vec{a}\|^2-\|\x\|^2
                    =r-\|\x-\vec{a}\|^2>0
                  \end{align*}
                  is the inequality defining an open ball of
                  radius $\sqrt{r}$ centered at $\vec{a}$ in $\R^d$ if $r$ is
                  positive and is not satisfied by any $\x\in\R^d$ otherwise.
                  Hence, $B_d\subseteq POS(U_d-\|\x\|^2)$, and therefore
                  $\VCdim(B_d)\leq d+1$.

                  We will show that $B_d$ shatters a set of size $d+1$, namely
                  $\{\vec{e}_i\}_{i=1}^{d}\cup\{\vec{0}\}$, where $\vec{e}_i$ is
                  the $i$th standard unit vector. Given a labelling $\vec{v}$,
                  let $S=\{\vec{e_i} \mid v_i=1\}$, and compute
                  $\vec{e}=\sum_{\vec{e}_i\in S} \vec{e}_i$. Note that
                  $\|\vec{0}-\vec{e}\|=|S|$, while
                  \[
                    \|\vec{e}_i-\vec{e}\|=\begin{cases}
                      |S|-1 & \text{if $\vec{e}_i\in S$}, \\
                      |S|+1 & \text{otherwise}.
                    \end{cases}
                  \]
                  Let $r=|S|-1/2$ if $v_{d+1}=0$ and $r=|S|+1/2$ if $v_{d+1}=1$
                  and note that then the open ball of radius $r$ centered at
                  $\vec{e}$ includes $\vec{e}_i$ if and only if $v_i=1$, and
                  includes $\vec{0}$ if and only if $v_{d+1}=1$.

                  Therefore, $\VCdim(B_d)=d+1$.
            \item Note that given two polynomials $h_p$ and $h_g$ in $n$
                  variables and degree at most $d$, $h_p(\x)+ch_g(\x)$ is also
                  a polynomial in $n$ variables of degree at most $d$. Hence,
                  $P^d_n$ is linearly closed and can be represented as a Dudley
                  class.
                  \begin{enumerate}[1.]
                    \item Note that there is an isomorphism between $P_1^n$ and
                          $\R^{n+1}$, given by
                          \[
                            \sum_{i=0}^n a_ix^i \mapsto (a_0, a_1, \ldots, a_n).
                          \]
                          Hence, $\VCdim(P^1_n)=n+1$.
                    \item Let $P_1$ be the class of all polynomial classifiers
                          over $\R$ and note that $P_1^n\subseteq P_1$ for all
                          $n$. Therefore, $\VCdim(P_1)\geq \VCdim(P_1^n)=n+1$,
                          but since $n$ was arbitrary, it follows that the VC
                          dimension is infinite.
                    \item Note that a monomial of degree at most $d$ in $n$
                          variables, corresponds to the number of ways to pick
                          $d$ elements from a set of size $n$ with repetition,
                          i.e.\ the number of ways to arrange $d$ dots and $n-1$
                          bars, which is
                          \[
                            N=\binom{d+n-1}{d}.
                          \]

                          Fix some monomial ordering $H: [N] \to \Z_{\geq 0}^d$ and
                          note that it induces an isomorphism between
                          $P^d_n$ and $\R^N$ given by
                          \[
                            \sum_{i=1}^N a_i\x^{H(i)} \mapsto (a_1,a_2,\ldots,a_N).
                          \]
                          Hence,
                          \[
                            \VCdim\left(P^d_n\right)=N={d+n-1}{d}.
                          \]
                  \end{enumerate}
          \end{enumerate}
  \end{enumerate}
\end{ex}